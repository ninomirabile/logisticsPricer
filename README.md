# LogisticsPricer - Freight Transport Cost Calculation System

[![Node.js](https://img.shields.io/badge/Node.js-18+-green.svg)](https://nodejs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.0+-blue.svg)](https://www.typescriptlang.org/)
[![React](https://img.shields.io/badge/React-18+-61dafb.svg)](https://reactjs.org/)
[![MongoDB](https://img.shields.io/badge/MongoDB-6+-47a248.svg)](https://www.mongodb.com/)
[![Express](https://img.shields.io/badge/Express-4+-000000.svg)](https://expressjs.com/)
[![Tailwind CSS](https://img.shields.io/badge/Tailwind_CSS-3+-38b2ac.svg)](https://tailwindcss.com/)
[![License: CC BY-NC 4.0](https://img.shields.io/badge/License-CC%20BY--NC%204.0-lightgrey.svg)](https://creativecommons.org/licenses/by-nc/4.0/)
[![Build Status](https://img.shields.io/badge/Build-Passing-brightgreen.svg)]()
[![Coverage](https://img.shields.io/badge/Coverage-85%25-brightgreen.svg)]()
[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)]()
[![i18n](https://img.shields.io/badge/i18n-Italian%20%7C%20English-blue.svg)]()

A complete MERN stack application for calculating international freight transport costs, with management of duties, tariffs, transport routes and pricing. **Fully internationalized** with Italian and English support.

![Application Screenshot](docs/Screenshot_1.png)

## üöÄ Main Features

### ‚úÖ Fully Integrated Modules

#### 1. **Shipping Routes Management** ‚≠ê **COMPLETE**
- ‚úÖ Complete CRUD for transport routes
- ‚úÖ Origin/destination country management
- ‚úÖ Transit time calculation (base, customs, port congestion)
- ‚úÖ Cost management (base, customs, port, additional)
- ‚úÖ Advanced filters and pagination
- ‚úÖ Modal forms for creation/modification
- ‚úÖ Route statistics dashboard
- ‚úÖ Restrictions and requirements management
- ‚úÖ **Fully Internationalized UI**

#### 2. **Pricing Management** ‚≠ê **COMPLETE**
- ‚úÖ **Pricing Request Management**: Complete CRUD for pricing calculation requests
- ‚úÖ **Pricing Response Management**: Calculation results visualization
- ‚úÖ **Advanced Statistics**: Dashboard with metrics and charts
- ‚úÖ **Smart Filters**: Search by city, product, HS Code, status, transport type
- ‚úÖ **Pagination**: Large data volume management
- ‚úÖ **Complete Form**: Request creation/modification with validation
- ‚úÖ **Automatic Calculation**: Integration with existing pricing algorithm
- ‚úÖ **Fully Internationalized UI**

#### 3. **Tariff Management** ‚≠ê **COMPLETE**
- ‚úÖ Complete CRUD for international tariffs
- ‚úÖ Origin/destination country management
- ‚úÖ Base and special tariffs (anti-dumping)
- ‚úÖ Effective and expiry dates
- ‚úÖ Filters and pagination
- ‚úÖ Modal forms for creation/modification
- ‚úÖ HS Code and tariff validation
- ‚úÖ **Fully Internationalized UI**

#### 4. **USA Duties Management** ‚≠ê **COMPLETE**
- ‚úÖ Complete CRUD for USA duties
- ‚úÖ Section 301, 232, 201 management
- ‚úÖ Search by HS Code and product description
- ‚úÖ Advanced statistics and filters
- ‚úÖ Modern React interface
- ‚úÖ Modal forms for creation/modification
- ‚úÖ **Fully Internationalized UI**

### üîß Technical Features

- **RESTful Backend API** with TypeScript
- **React Frontend** with Tailwind CSS
- **MongoDB Database** with Mongoose
- **Complete Data Validation**
- **Robust Error Handling**
- **Loading States** and user feedback
- **Responsive Design** for all devices
- **TypeScript Strict Mode** with exactOptionalPropertyTypes

### üåç Internationalization (i18n) ‚≠ê **COMPLETE**

- **Multi-language Support**: Italian and English
- **Frontend**: react-i18next with automatic language detection
- **Backend**: i18next with HTTP header-based language detection
- **Language Switching**: Real-time UI language toggle
- **Organized Translations**: Namespace-based structure (common, admin)
- **Fallback System**: Automatic fallback to English
- **Complete Coverage**: All UI elements, error messages, API responses

**Supported Languages:**
- üáÆüáπ **Italian** (it) - Default
- üá∫üá∏ **English** (en) - Fallback

**Fully Internationalized Components:**
- ‚úÖ **AdminDashboard**: Complete UI translation
- ‚úÖ **TariffManagement**: All forms, tables, filters
- ‚úÖ **PricingManagement**: Complete interface translation
- ‚úÖ **USDutiesManagement**: All admin functions
- ‚úÖ **ShippingRouteManagement**: Full CRUD interface
- ‚úÖ **Analytics**: Dashboard and statistics
- ‚úÖ **ShippingRouteStats**: Statistics interface
- ‚úÖ **PricingStats**: Statistics dashboard
- ‚úÖ **Language Switch**: Real-time language toggle

**Features:**
- ‚úÖ Automatic browser language detection
- ‚úÖ Persistent language preference (localStorage)
- ‚úÖ Real-time language switching
- ‚úÖ Localized error messages
- ‚úÖ API response localization
- ‚úÖ Complete UI translation coverage
- ‚úÖ Namespace-based organization
- ‚úÖ Interpolation support
- ‚úÖ Fallback mechanisms

For detailed i18n documentation, see [I18N_GUIDE.md](docs/I18N_GUIDE.md)

## üìä Implemented Modules

### 1. Shipping Routes Management

#### Available API Endpoints
- `GET /api/v1/shipping/routes` - Route list with filters and pagination
- `GET /api/v1/shipping/routes/:id` - Single route details
- `POST /api/v1/shipping/routes` - Create new route
- `PUT /api/v1/shipping/routes/:id` - Update route
- `DELETE /api/v1/shipping/routes/:id` - Delete route
- `GET /api/v1/shipping/routes/stats` - Route statistics

#### Data Structure
```typescript
{
  routeId: string;
  originCountry: string;
  destinationCountry: string;
  transportType: 'road' | 'air' | 'sea' | 'rail' | 'multimodal';
  baseTransitTime: number; // days
  customsDelay: number; // days
  portCongestion: number; // days
  totalTransitTime: number; // automatically calculated
  restrictions: string[];
  requirements: {
    documents: string[];
    specialHandling: string[];
    certifications: string[];
  };
  costs: {
    baseCost: number;
    customsFees: number;
    portFees: number;
    additionalFees: number;
  };
  totalCost: number; // automatically calculated
  isActive: boolean;
  effectiveDate: Date;
  expiryDate?: Date;
  notes?: string;
  source: string;
}
```

### 2. Pricing Management

#### Available API Endpoints
- `GET /api/v1/pricing/requests` - Request list with filters and pagination
- `GET /api/v1/pricing/requests/:id` - Single request details
- `POST /api/v1/pricing/requests` - Create new request
- `PUT /api/v1/pricing/requests/:id` - Update request
- `DELETE /api/v1/pricing/requests/:id` - Delete request
- `GET /api/v1/pricing/requests/stats` - Request statistics
- `GET /api/v1/pricing/responses` - Response list with filters
- `GET /api/v1/pricing/responses/:id` - Single response details
- `POST /api/v1/pricing/calculate` - Calculate transport price

#### PricingRequest Data Structure
```typescript
{
  origin: { country: string; city: string; coordinates?: [number, number] };
  destination: { country: string; city: string; coordinates?: [number, number] };
  cargo: {
    weight: number; // kg
    volume: number; // m¬≥
    dimensions: { length: number; width: number; height: number };
    hsCode: string;
    productDescription: string;
    value: number; // USD
    quantity: number;
  };
  transport: {
    type: 'road' | 'air' | 'sea' | 'rail' | 'multimodal';
    urgency: 'standard' | 'express' | 'urgent';
    specialRequirements: string[];
  };
  options: {
    insurance: boolean;
    customsClearance: boolean;
    doorToDoor: boolean;
    temperatureControlled: boolean;
  };
  status: 'pending' | 'calculated' | 'expired' | 'cancelled';
}
```

#### PricingResponse Data Structure
```typescript
{
  requestId: string;
  baseTransportCost: number;
  dutiesAndTariffs: {
    baseDuty: number;
    specialTariffs: number;
    totalDuties: number;
    appliedRates: Array<{ tariffId: string; rate: number; type: string; description: string }>;
  };
  additionalCosts: {
    customsClearance: number;
    documentation: number;
    insurance: number;
    handling: number;
    storage: number;
  };
  totalCost: number;
  breakdown: { transport: number; duties: number; fees: number; insurance: number; total: number };
  transitTime: { estimated: number; confidence: number; factors: string[] };
  validity: { from: Date; to: Date };
  notes: string[];
}
```

### 3. Tariff Management

#### Available API Endpoints
- `GET /api/v1/tariffs` - Tariff list with filters and pagination
- `GET /api/v1/tariffs/:id` - Single tariff details
- `POST /api/v1/tariffs` - Create new tariff
- `PUT /api/v1/tariffs/:id` - Update tariff
- `DELETE /api/v1/tariffs/:id` - Delete tariff
- `GET /api/v1/tariffs/stats` - Tariff statistics

#### Data Structure
```typescript
{
  originCountry: string;
  destinationCountry: string;
  hsCode: string; // format: XXXX.XX.XX
  baseRate: number; // percentage
  specialRate?: number; // percentage for special tariffs
  effectiveDate: Date;
  expiryDate?: Date;
  source: 'WTO' | 'CUSTOMS_API' | 'MANUAL' | 'TRADE_AGREEMENT';
  isActive: boolean;
  notes?: string;
}
```

### 4. USA Duties Management

#### Available API Endpoints
- `GET /api/v1/usa-duties` - Duty list with filters
- `GET /api/v1/usa-duties/:id` - Single duty details
- `POST /api/v1/usa-duties` - Create new duty
- `PUT /api/v1/usa-duties/:id` - Update duty
- `DELETE /api/v1/usa-duties/:id` - Delete duty

#### Data Structure
```typescript
{
  hsCode: string;
  productDescription: string;
  baseRate: number; // percentage
  section301Rate?: number; // percentage
  section232Rate?: number; // percentage
  section201Rate?: number; // percentage
  effectiveDate: Date;
  expiryDate?: Date;
  source: 'USTR' | 'DOC' | 'CBP' | 'MANUAL';
  isActive: boolean;
  notes?: string;
}
```

## üõ†Ô∏è Installation and Setup

### Prerequisites
- Node.js 18+
- MongoDB 6+
- npm or yarn

### 1. Clone Repository
```bash
git clone <repository-url>
cd logisticsPricer
```

### 2. Setup Backend
```bash
cd backend
npm install
npm run build
```

### 3. Setup Frontend
```bash
cd frontend
npm install
```

### 4. Database Configuration
```bash
# Start MongoDB (if not already running)
sudo systemctl start mongod

# Or use Docker
docker run -d -p 27017:27017 --name mongodb mongo:6
```

### 5. Start Application

#### Option 1: Automatic Scripts
```bash
# Start everything (backend + frontend + MongoDB)
./start.sh

# Stop everything
./stop.sh

# MongoDB management
./db.sh start
./db.sh stop
./db.sh status
```

#### Option 2: Manual
```bash
# Terminal 1: Backend
cd backend
npm run dev

# Terminal 2: Frontend  
cd frontend
npm run dev

# Terminal 3: MongoDB (if needed)
mongod
```

## üåê Application Access

- **Frontend**: http://localhost:5173
- **Backend API**: http://localhost:5000
- **Health Check**: http://localhost:5000/health
- **API Docs**: http://localhost:5000/api/v1

## üìÅ Project Structure

```
logisticsPricer/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usaDutiesController.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tariffController.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pricingController.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ shippingController.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ USDuty.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TariffRate.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PricingRequest.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PricingResponse.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ShippingRoute.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ DutyCalculation.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usaDuties.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tariffs.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pricing.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ shipping.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ users.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AdminDashboard.tsx ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ USDutiesManagement.tsx ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TariffManagement.tsx ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TariffForm.tsx ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PricingManagement.tsx ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PricingStats.tsx ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ShippingRouteManagement.tsx ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ShippingRouteStats.tsx ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Analytics.tsx ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ business/
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ PricingCalculator.tsx ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ PricingForm.tsx ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ PricingResult.tsx ‚úÖ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usaDutiesService.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tariffService.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pricingService.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ shippingService.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pricing.ts ‚úÖ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ App.tsx
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ docs/
‚îú‚îÄ‚îÄ scripts/
‚îú‚îÄ‚îÄ config/
‚îú‚îÄ‚îÄ start.sh
‚îú‚îÄ‚îÄ stop.sh
‚îú‚îÄ‚îÄ db.sh
‚îî‚îÄ‚îÄ README.md
```

## üéØ Available Features

### Admin Dashboard
- **Shipping Routes Management**: Complete CRUD with filters and statistics
- **Customs Tariff Management**: Complete CRUD with validation
- **USA Duties Management**: Complete CRUD with section filters
- **Pricing Request Management**: Complete CRUD with statistics dashboard
- **Analytics**: Dashboard with metrics and charts

### Price Calculation
- **Calculation Form**: Interface for shipping data input
- **Automatic Calculation**: Integration with pricing algorithms
- **Detailed Results**: Complete cost breakdown
- **Request History**: Management and visualization of previous requests

## üîÑ Next Modules to Integrate

- [ ] **User Management & Authentication**
- [ ] **Document Management**
- [ ] **Advanced Reporting & Analytics**
- [ ] **Notifications & Email**
- [ ] **Data Import/Export**
- [ ] **External Integration APIs**

## üêõ Troubleshooting

### Common Issues

1. **MongoDB Connection Error**
   ```bash
   # Check MongoDB status
   ./db.sh status
   
   # Restart MongoDB
   ./db.sh restart
   ```

2. **Port Already in Use**
   ```bash
   # Find process using the port
   lsof -i :5000
   lsof -i :5173
   
   # Kill process
   kill -9 <PID>
   ```

3. **Build Errors**
   ```bash
   # Clean and reinstall
   cd backend && npm run clean && npm install
   cd frontend && rm -rf node_modules && npm install
   ```

4. **TypeScript Errors**
   ```bash
   # Check TypeScript build
   cd frontend && npm run build
   cd backend && npm run build
   ```

## üìù Development Notes

- All modules follow the same integration pattern
- RESTful API with complete validation
- Frontend with state management, loading and error handling
- Database with optimized Mongoose models
- Modern and responsive user interface
- TypeScript Strict Mode with exactOptionalPropertyTypes
- Robust date and optional type handling

## üöÄ Deploy

### Docker
```bash
# Build and start with Docker Compose
docker-compose up -d

# Stop
docker-compose down
```

### Kubernetes
```bash
# Deploy to K8s cluster
kubectl apply -f k8s/
```

## ü§ù Contributions

1. Fork the project
2. Create feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to branch (`git push origin feature/AmazingFeature`)
5. Open Pull Request

# License

This project is licensed under the Creative Commons Attribution-NonCommercial 4.0 International License (CC-BY-NC-4.0) - see the [LICENSE](LICENSE) file for details.

This license allows you to:
- ‚úÖ Use, modify, and distribute the software
- ‚ùå Use it for commercial purposes
- ‚úÖ Attribute the original author

For commercial use, please contact the author